function t(t,r,e){void 0===r&&(r="text/plain"),void 0===e&&(e=200),this.writeHead(e,{"Content-Type":r}),this.end(t,!1,!1)}exports.Lieve=function(r){this.routes=r,this.before=r.before||[],this.after=r.after||[],this.list=function(t){var r=Object.keys(t).map(function(t){return t.split("/").slice(1)}).flat().filter(function(t){return":par"!==t});return Array.from(new Set(r))}(r),this.matchPar=new RegExp(/[^\/]+$/),this.matchUrl=new RegExp(/\/$|\?(.*)/),this.find=function(t){if("/"===t)return{path:t,par:void 0};var r=t.replace(this.matchUrl,"");return par=r.match(this.matchPar)[0],path=this.list.indexOf(par)>-1?r:r.replace(par,":par"),{path:path,par:par}}.bind(this),this.router=function(r,e){var i=r.url,n=r.method;r.par=o,r.queue=p,r.index=0,r.next=function(){return this.index+=1,this.queue[this.index]}.bind(r),e.send=t;var a=this.find(i),o=a.par,s=this.routes[a.path]||{},u=s.before;void 0===u&&(u=[]);var f=s.after;void 0===f&&(f=[]);var c=s[n];if(c){var p=this.before.concat(u,[c],f,this.after);p[0](r,e)}else e.send(JSON.stringify({error:"Not Found",status:404}),"application/json",404)}.bind(this)},exports._body=function(t,r){return new Promise(function(e){var i=[];t.on("data",function(t){return i.push(t)}),t.on("end",function(){var t=Buffer.concat(i).toString();switch(r){case"x-www-form-urlencoded":var n={};t.split("&").map(function(t){var r=t.split("=");n[r[0]]=r[1]}),e(n);break;case"binary":e({file:t});break;default:e(t)}})})},exports._cookie=function(t){var r=t.headers.cookie;if(!r)return{};var e={};return r.split(";").forEach(function(t){var r=t.split("=").map(function(t){return t.trim()});e[r[0]]=r[1]}),e},exports._query=function(t,r){void 0===r&&(r="&");var e={};return t.url.match(/[^?]+$/)[0].split(r).map(function(t){var r=t.split("=");e[r[0]]=r[1]}),e},exports._set=function(t,r,e,i){void 0===i&&(i=!1),Object.defineProperty(t,r,{value:e,writable:i})};
//# sourceMappingURL=lieve.js.map
